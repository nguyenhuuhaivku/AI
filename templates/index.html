<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Language Learning Chatbot - H·ªçc Ngo·∫°i Ng·ªØ v·ªõi AI</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">
                <i class="fas fa-graduation-cap"></i>
                <h1>English Learning</h1>
            </div>
            
            <!-- ƒê√£ b·ªè ph·∫ßn ch·ªçn c·∫•p ƒë·ªô -->
            
            <div class="learning-modes">
                <h3>Menu</h3>
                <button class="mode-btn active" data-mode="chat">
                    <i class="fas fa-comments"></i>
                    <span>Chat v·ªõi AI</span>
                </button>
                <button class="mode-btn" data-mode="history">
                    <i class="fas fa-history"></i>
                    <span>L·ªãch s·ª≠ Chat</span>
                </button>
                <button class="mode-btn" data-mode="vocabulary">
                    <i class="fas fa-book"></i>
                    <span>H·ªçc t·ª´ v·ª±ng</span>
                </button>
                <button class="mode-btn" data-mode="listening">
                    <i class="fas fa-headphones"></i>
                    <span>Luy·ªán nghe</span>
                </button>
                <button class="mode-btn" data-mode="game">
                    <i class="fas fa-gamepad"></i>
                    <span>Game t·ª´ v·ª±ng</span>
                </button>
            </div>
            
            <!-- ƒê√£ b·ªè ph·∫ßn ti·∫øn tr√¨nh h·ªçc t·∫≠p -->
        </aside>
        
        <!-- Main Content Area -->
        <main class="chat-container">
            <div class="chat-header">
                <div class="header-left">
                    <div class="bot-avatar">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div>
                        <h2 id="sectionTitle">Chat v·ªõi AI Assistant</h2>
                        <p class="status"><span class="status-dot"></span>S·∫µn s√†ng tr·∫£ l·ªùi c√¢u h·ªèi c·ªßa b·∫°n</p>
                    </div>
                </div>
                <div class="header-right">
                    <button class="icon-btn" onclick="showHelp()" title="H∆∞·ªõng d·∫´n">
                        <i class="fas fa-question-circle"></i>
                    </button>
                </div>
            </div>
            
            <!-- Chat Section -->
            <div class="content-section active" id="chatSection">
                <div class="chat-messages" id="chatMessages">
                    <div class="message bot-message">
                        <div class="message-avatar">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="message-content">
                            <p>üëã Xin ch√†o! T√¥i l√† tr·ª£ l√Ω AI c·ªßa b·∫°n.</p>
                            <p>üí¨ B·∫°n c√≥ th·ªÉ h·ªèi t√¥i b·∫•t c·ª© ƒëi·ªÅu g√¨ b·∫±ng ti·∫øng Vi·ªát ho·∫∑c ti·∫øng Anh!</p>
                            <p>üìö S·ª≠ d·ª•ng menu b√™n tr√°i ƒë·ªÉ h·ªçc t·ª´ v·ª±ng, ng·ªØ ph√°p v√† l√†m b√†i t·∫≠p.</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Chat History Section -->
            <div class="content-section" id="historySection">
                <div class="history-content">
                    <h3>üìú L·ªãch s·ª≠ Chat</h3>
                    <div id="chatHistoryList" class="history-list"></div>
                </div>
            </div>
            
            <!-- Vocabulary Section -->
            <div class="content-section" id="vocabularySection">
                <div class="vocabulary-content">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3>üìö T·ª´ v·ª±ng c·ªßa b·∫°n</h3>
                        <div style="background: rgba(103,126,234,0.2); padding: 8px 16px; border-radius: 20px; color: var(--primary-color); font-weight: 600;">
                            <i class="fas fa-book"></i> <span id="totalVocabCount">0</span> t·ª´
                        </div>
                    </div>
                    
                    <!-- Form th√™m t·ª´ m·ªõi -->
                    <div class="add-vocab-form" style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 12px; margin-bottom: 20px;">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <button onclick="toggleAddVocabForm()" id="toggleAddBtn" style="padding: 8px 16px; border-radius: 8px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; cursor: pointer; font-weight: 600; font-size: 14px;">
                                <i class="fas fa-plus"></i> Th√™m t·ª´ m·ªõi
                            </button>
                            <span style="color: var(--text-secondary); font-size: 13px;">‚ú® AI t·ª± ƒë·ªông b·ªï sung phi√™n √¢m, v√≠ d·ª•</span>
                        </div>
                        <div id="addVocabFormContent" style="display: none; margin-top: 15px;">
                            <div style="display: grid; gap: 10px;">
                                <input type="text" id="newWord" placeholder="T·ª´ ti·∫øng Anh (VD: computer)" style="padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.1); color: white; font-size: 14px;">
                                <input type="text" id="newMeaningVi" placeholder="Nghƒ©a ti·∫øng Vi·ªát (VD: m√°y t√≠nh)" style="padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.1); color: white; font-size: 14px;">
                                <div style="display: flex; gap: 8px;">
                                    <button onclick="addNewVocabulary()" style="flex: 1; padding: 10px; border-radius: 8px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; cursor: pointer; font-weight: 600; font-size: 14px;">
                                        <i class="fas fa-check"></i> Th√™m t·ª´
                                    </button>
                                    <button onclick="toggleAddVocabForm()" style="padding: 10px 16px; border-radius: 8px; background: rgba(255,255,255,0.1); color: white; border: none; cursor: pointer; font-size: 14px;">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Thanh t√¨m ki·∫øm v√† l·ªçc -->
                    <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 12px; margin-bottom: 20px;">
                        <div style="display: grid; grid-template-columns: 1fr auto auto; gap: 10px; align-items: center;">
                            <div style="position: relative;">
                                <i class="fas fa-search" style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text-secondary);"></i>
                                <input type="text" id="searchVocab" placeholder="T√¨m t·ª´ v·ª±ng..." onkeyup="filterVocabulary()" style="width: 100%; padding: 10px 10px 10px 40px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.1); color: white; font-size: 14px;">
                            </div>
                            <select id="topicFilter" onchange="filterVocabulary()" style="padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.1); color: white; font-size: 14px; cursor: pointer;">
                                <option value="all">üìö T·∫•t c·∫£ ch·ªß ƒë·ªÅ</option>
                            </select>
                            <select id="sortVocab" onchange="filterVocabulary()" style="padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.1); color: white; font-size: 14px; cursor: pointer;">
                                <option value="newest">üÜï M·ªõi nh·∫•t</option>
                                <option value="oldest">üìÖ C≈© nh·∫•t</option>
                                <option value="az">üî§ A ‚Üí Z</option>
                                <option value="za">üî§ Z ‚Üí A</option>
                            </select>
                        </div>
                    </div>
                    
                    <div id="vocabularyList" class="vocabulary-list"></div>
                </div>
            </div>
            
            <!-- Listening Practice Section -->
            <div class="content-section" id="listeningSection">
                <div class="listening-content">
                    <h3>üéß Luy·ªán nghe ti·∫øng Anh</h3>
                    
                    <div class="listening-controls" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; padding: 25px; background: var(--bg-secondary); border-radius: 16px;">
                        <div>
                            <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: 600;">üìä ƒê·ªô kh√≥:</label>
                            <select id="listeningDifficulty" style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border-color); background: var(--bg-tertiary); color: var(--text-primary);">
                                <option value="easy">üü¢ D·ªÖ (5-7 t·ª´, c√¢u ƒë∆°n gi·∫£n)</option>
                                <option value="medium" selected>üü° Trung b√¨nh (8-12 t·ª´)</option>
                                <option value="hard">üî¥ Kh√≥ (13-20 t·ª´, c√¢u ph·ª©c t·∫°p)</option>
                            </select>
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: 600;">üéØ Ch·ªß ƒë·ªÅ:</label>
                            <select id="listeningTopic" style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border-color); background: var(--bg-tertiary); color: var(--text-primary);">
                                <option value="daily">üí¨ H·ªôi tho·∫°i h√†ng ng√†y</option>
                                <option value="business">üíº Kinh doanh</option>
                                <option value="travel">‚úàÔ∏è Du l·ªãch</option>
                                <option value="academic">üìö H·ªçc thu·∫≠t</option>
                                <option value="news">üì∞ Tin t·ª©c</option>
                            </select>
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: 600;">üé§ Gi·ªçng n√≥i:</label>
                            <select id="listeningVoice" style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border-color); background: var(--bg-tertiary); color: var(--text-primary);">
                                <option value="us-female">üá∫üá∏ M·ªπ - N·ªØ</option>
                                <option value="us-male">üá∫üá∏ M·ªπ - Nam</option>
                            </select>
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 8px; color: var(--text-primary); font-weight: 600;">‚ö° T·ªëc ƒë·ªô: <span id="speedValue">1.0x</span></label>
                            <input type="range" id="listeningSpeed" min="0.5" max="1.5" step="0.1" value="1.0" style="width: 100%;" oninput="document.getElementById('speedValue').textContent = this.value + 'x'">
                        </div>
                        
                        <div style="grid-column: 1 / -1; text-align: center; margin-top: 10px;">
                            <button onclick="startListening()" class="btn-primary" style="padding: 15px 40px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; border-radius: 12px; color: white; cursor: pointer; font-weight: 600; font-size: 16px; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4); transition: transform 0.2s;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                                <i class="fas fa-play-circle"></i> B·∫Øt ƒë·∫ßu luy·ªán nghe
                            </button>
                        </div>
                    </div>
                    
                    <div id="listeningExercise" style="display: none;">
                        <div style="background: linear-gradient(135deg, #667eea20 0%, #764ba220 100%); padding: 40px; border-radius: 20px; margin-bottom: 25px;">
                            <div style="text-align: center; margin-bottom: 25px;">
                                <div style="font-size: 18px; color: var(--text-secondary); margin-bottom: 20px; font-weight: 500;">
                                    üéß Nghe k·ªπ v√† vi·∫øt l·∫°i c√¢u b·∫°n nghe ƒë∆∞·ª£c
                                </div>
                                <div style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap;">
                                    <button onclick="playListeningSentence('normal')" class="listen-btn" style="padding: 25px 35px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; border-radius: 16px; color: white; cursor: pointer; font-size: 18px; box-shadow: 0 8px 20px rgba(103,126,234,0.4); transition: all 0.3s; font-weight: 600;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                                        <i class="fas fa-volume-up"></i> Nghe
                                    </button>
                                    <button onclick="playListeningSentence('slow')" style="padding: 25px 35px; background: var(--bg-tertiary); border: 2px solid var(--primary-color); border-radius: 16px; color: var(--text-primary); cursor: pointer; font-size: 18px; transition: all 0.3s; font-weight: 600;" onmouseover="this.style.background='var(--primary-color)'; this.style.color='white'" onmouseout="this.style.background='var(--bg-tertiary)'; this.style.color='var(--text-primary)'">
                                        <i class="fas fa-turtle"></i> Nghe ch·∫≠m
                                    </button>
                                </div>
                                <div id="playCount" style="margin-top: 15px; color: var(--text-secondary); font-size: 14px;">
                                    ƒê√£ nghe: <strong>0</strong> l·∫ßn
                                </div>
                            </div>
                            
                            <div style="position: relative;">
                                <input type="text" id="listeningAnswer" placeholder="‚úçÔ∏è Nh·∫≠p c√¢u b·∫°n nghe ƒë∆∞·ª£c (ti·∫øng Anh)..." style="width: 100%; padding: 18px 20px; border-radius: 12px; border: 2px solid var(--border-color); background: white; color: var(--text-primary); font-size: 17px; margin-bottom: 20px; transition: border-color 0.3s;" onfocus="this.style.borderColor='var(--primary-color)'" onblur="this.style.borderColor='var(--border-color)'">
                                <div style="display: flex; gap: 10px; align-items: center; margin-bottom: 15px;">
                                    <input type="checkbox" id="showHints" onchange="toggleHints()" style="width: 18px; height: 18px; cursor: pointer;">
                                    <label for="showHints" style="color: var(--text-primary); cursor: pointer; user-select: none;">üí° Hi·ªán g·ª£i √Ω (s·ªë k√Ω t·ª±, ch·ªØ c√°i ƒë·∫ßu)</label>
                                </div>
                                <div id="hintArea" style="display: none; padding: 12px; background: rgba(102, 126, 234, 0.1); border-radius: 8px; margin-bottom: 15px; font-size: 14px; color: var(--text-secondary);"></div>
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; margin-bottom: 20px;">
                            <button onclick="checkListeningAnswer()" class="btn-primary" style="padding: 14px 28px; background: var(--success-color); border: none; border-radius: 10px; color: white; cursor: pointer; font-weight: 600; font-size: 15px; box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);">
                                <i class="fas fa-check-circle"></i> Ki·ªÉm tra
                            </button>
                            <button onclick="showListeningSentence()" class="btn-secondary" style="padding: 14px 28px; background: #ff9800; border: none; border-radius: 10px; color: white; cursor: pointer; font-weight: 600; font-size: 15px;">
                                <i class="fas fa-eye"></i> Xem ƒë√°p √°n
                            </button>
                            <button onclick="startListening()" class="btn-secondary" style="padding: 14px 28px; background: var(--primary-color); border: none; border-radius: 10px; color: white; cursor: pointer; font-weight: 600; font-size: 15px;">
                                <i class="fas fa-forward"></i> C√¢u ti·∫øp theo
                            </button>
                        </div>
                        
                        <div id="listeningResult" style="margin-top: 20px; display: none;">
                            <div id="listeningResultContent" style="padding: 25px; background: var(--bg-secondary); border-radius: 16px; border: 2px solid var(--border-color);"></div>
                        </div>
                    </div>
                    
                    <div id="listeningStats" style="margin-top: 30px; padding: 25px; background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%); border-radius: 16px; border: 2px solid var(--border-color);">
                        <h4 style="margin-bottom: 20px; color: var(--primary-color); font-size: 18px;">
                            <i class="fas fa-chart-line"></i> Th·ªëng k√™ phi√™n luy·ªán t·∫≠p
                        </h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                            <div style="text-align: center; padding: 15px; background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                <div style="font-size: 32px; font-weight: bold; color: var(--primary-color);" id="listeningTotal">0</div>
                                <div style="color: var(--text-secondary); font-size: 14px; margin-top: 5px;">T·ªïng c√¢u</div>
                            </div>
                            <div style="text-align: center; padding: 15px; background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                <div style="font-size: 32px; font-weight: bold; color: var(--success-color);" id="listeningCorrect">0</div>
                                <div style="color: var(--text-secondary); font-size: 14px; margin-top: 5px;">ƒê√∫ng</div>
                            </div>
                            <div style="text-align: center; padding: 15px; background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                <div style="font-size: 32px; font-weight: bold; color: #ff9800;" id="listeningAccuracy">0%</div>
                                <div style="color: var(--text-secondary); font-size: 14px; margin-top: 5px;">ƒê·ªô ch√≠nh x√°c</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Game Section -->
            <div class="content-section" id="gameSection">
                <div class="game-content">
                    <h3>üéÆ Game gh√©p t·ª´ vui nh·ªôn</h3>
                    
                    <div id="gameStart" style="text-align: center; padding: 40px;">
                        <i class="fas fa-gamepad" style="font-size: 64px; color: var(--primary-color); margin-bottom: 20px;"></i>
                        <h2>Gh√©p t·ª´ v·ªõi nghƒ©a</h2>
                        <p style="color: var(--text-secondary); margin: 20px 0;">T√¨m c√°c c·∫∑p t·ª´ v√† nghƒ©a kh·ªõp v·ªõi nhau nhanh nh·∫•t!</p>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 10px; color: var(--text-primary); font-weight: 600;">Ch·ªçn ch·ªß ƒë·ªÅ:</label>
                            <select id="gameTopic" style="padding: 10px 20px; border-radius: 8px; border: 1px solid var(--border-color); background: var(--bg-secondary); color: var(--text-primary); min-width: 250px;">
                                <option value="my_vocabulary">üìö T·ª´ v·ª±ng ƒë√£ h·ªçc c·ªßa t√¥i</option>
                                <option value="technology">üíª Technology (C√¥ng ngh·ªá)</option>
                                <option value="food">üçî Food (ƒê·ªì ƒÉn)</option>
                                <option value="business">üíº Business (Kinh doanh)</option>
                                <option value="education">üìñ Education (Gi√°o d·ª•c)</option>
                                <option value="health">ÔøΩ Health (S·ª©c kh·ªèe)</option>
                                <option value="travel">‚úàÔ∏è Travel (Du l·ªãch)</option>
                                <option value="sports">‚öΩ Sports (Th·ªÉ thao)</option>
                                <option value="music">üéµ Music (√Çm nh·∫°c)</option>
                                <option value="nature">üåø Nature (Thi√™n nhi√™n)</option>
                                <option value="animals">üêæ Animals (ƒê·ªông v·∫≠t)</option>
                                <option value="weather">üå§Ô∏è Weather (Th·ªùi ti·∫øt)</option>
                                <option value="family">üë®‚Äçüë©‚Äçüëß Family (Gia ƒë√¨nh)</option>
                                <option value="emotions">üòä Emotions (C·∫£m x√∫c)</option>
                                <option value="general">üåê General (T·ªïng h·ª£p)</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 10px; color: var(--text-primary); font-weight: 600;">S·ªë c·∫∑p:</label>
                            <select id="gamePairCount" style="padding: 10px 20px; border-radius: 8px; border: 1px solid var(--border-color); background: var(--bg-secondary); color: var(--text-primary);">
                                <option value="4">4 c·∫∑p (D·ªÖ) ‚≠ê</option>
                                <option value="6" selected>6 c·∫∑p (Trung b√¨nh) ‚≠ê‚≠ê</option>
                                <option value="8">8 c·∫∑p (Kh√≥) ‚≠ê‚≠ê‚≠ê</option>
                                <option value="10">10 c·∫∑p (C·ª±c kh√≥) ‚≠ê‚≠ê‚≠ê‚≠ê</option>
                            </select>
                        </div>
                        
                        <button onclick="startGame()" class="btn-primary" style="padding: 15px 30px; background: var(--primary-color); border: none; border-radius: 8px; color: white; cursor: pointer; font-weight: 600; font-size: 16px;">
                            <i class="fas fa-play"></i> B·∫Øt ƒë·∫ßu ch∆°i
                        </button>
                    </div>
                    
                    <div id="gameArea" style="display: none;">
                        <div class="game-stats" style="display: flex; justify-content: space-around; margin-bottom: 20px; padding: 15px; background: var(--bg-secondary); border-radius: 12px;">
                            <div>
                                <div style="font-size: 24px; font-weight: bold; color: var(--primary-color);" id="gameScore">0</div>
                                <div style="color: var(--text-secondary); font-size: 14px;">ƒêi·ªÉm</div>
                            </div>
                            <div>
                                <div style="font-size: 24px; font-weight: bold; color: var(--success-color);" id="gamePairs">0</div>
                                <div style="color: var(--text-secondary); font-size: 14px;">C·∫∑p ƒë√£ t√¨m</div>
                            </div>
                            <div>
                                <div style="font-size: 24px; font-weight: bold; color: var(--warning-color);" id="gameTime">0s</div>
                                <div style="color: var(--text-secondary); font-size: 14px;">Th·ªùi gian</div>
                            </div>
                        </div>
                        
                        <div id="gameCards" class="game-cards" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px;"></div>
                    </div>
                    
                    <div id="gameResult" style="display: none; text-align: center; padding: 40px;">
                        <h2 style="color: var(--success-color); margin-bottom: 20px;">üèÜ Chi·∫øn th·∫Øng!</h2>
                        <div id="finalGameScore" style="font-size: 48px; font-weight: bold; color: var(--primary-color); margin: 20px 0;"></div>
                        <p id="finalGameTime" style="font-size: 18px; color: var(--text-secondary); margin-bottom: 30px;"></p>
                        <button onclick="restartGame()" class="btn-primary" style="padding: 12px 24px; background: var(--primary-color); border: none; border-radius: 8px; color: white; cursor: pointer; font-weight: 600;">
                            <i class="fas fa-redo"></i> Ch∆°i l·∫°i
                        </button>
                    </div>
                    
                    <div id="gameLeaderboard" style="margin-top: 30px; padding: 20px; background: var(--bg-secondary); border-radius: 12px;">
                        <h4 style="margin-bottom: 15px;">üèÖ B·∫£ng x·∫øp h·∫°ng c·ªßa b·∫°n</h4>
                        <div id="leaderboardList"></div>
                    </div>
                </div>
            </div>
            
            <div class="chat-input-container" id="chatInputContainer">
                <div class="input-tools">
                    <button class="tool-btn" id="micBtn" onclick="toggleSpeechRecognition()" title="N√≥i ti·∫øng Anh">
                        <i class="fas fa-microphone"></i>
                    </button>
                </div>
                <input 
                    type="text" 
                    id="messageInput" 
                    placeholder="Nh·∫≠p tin nh·∫Øn c·ªßa b·∫°n..." 
                    onkeypress="handleKeyPress(event)"
                >
                <button class="send-btn" onclick="sendMessage()">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
            
            <div class="quick-suggestions" id="quickSuggestions">
                <span class="suggestion-label">G·ª£i √Ω:</span>
                <button class="suggestion-btn" onclick="quickMessage('Xin ch√†o, b·∫°n l√† ai?')">
                    Xin ch√†o
                </button>
                <button class="suggestion-btn" onclick="quickMessage('B·∫°n c√≥ th·ªÉ gi√∫p g√¨ cho t√¥i?')">
                    C·∫ßn gi√∫p ƒë·ª°
                </button>
                <button class="suggestion-btn" onclick="quickMessage('Gi·∫£i th√≠ch v·ªÅ...')">
                    H·ªèi ƒë√°p
                </button>
            </div>
        </main>
    </div>
    
    <!-- Modal for Progress Details -->
    <div id="progressModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('progressModal')">&times;</span>
            <h2><i class="fas fa-chart-bar"></i> Chi ti·∫øt ti·∫øn tr√¨nh h·ªçc t·∫≠p</h2>
            <div id="progressDetails"></div>
        </div>
    </div>
    
    <!-- Modal for Grammar Tips -->
    <div id="grammarModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('grammarModal')">&times;</span>
            <h2><i class="fas fa-lightbulb"></i> Grammar Tips</h2>
            <div id="grammarTips"></div>
        </div>
    </div>
    
    <!-- Modal for Vocabulary -->
    <div id="vocabularyModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('vocabularyModal')">&times;</span>
            <h2><i class="fas fa-book-open"></i> Vocabulary</h2>
            <div id="vocabularyContent"></div>
        </div>
    </div>
    
    <!-- Modal for Pronunciation Practice -->
    <div id="pronunciationModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('pronunciationModal')">&times;</span>
            <h2><i class="fas fa-microphone-alt"></i> Luy·ªán ph√°t √¢m</h2>
            <div id="pronunciationContent">
                <div class="pronunciation-practice">
                    <p id="practiceSentence">Loading...</p>
                    <button class="btn-primary" onclick="playAudio()">
                        <i class="fas fa-play"></i> Nghe
                    </button>
                    <button class="btn-secondary" onclick="recordPronunciation()">
                        <i class="fas fa-microphone"></i> Ghi √¢m c·ªßa b·∫°n
                    </button>
                    <div id="pronunciationResult"></div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
